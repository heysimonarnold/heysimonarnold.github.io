---
import { SITE } from "@/configs/site";
const isProd = import.meta.env.PROD;
---

{isProd && (
  <>
  <script
    async
    src={`https://www.googletagmanager.com/gtag/js?id=${SITE.googleAnalyticsKey}`}
  />

  <script is:inline>
    const key = `${JSON.stringify(SITE.googleAnalyticsKey)}`;

    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());
    gtag("config", key);
  </script>

  {/* Pour la navigation client-side d'Astro */}
  <script is:inline>
    document.addEventListener('astro:page-load', () => {
      if (typeof gtag === 'function') {
        gtag('event', 'page_view', {
          page_path: window.location.pathname,
        });
      }
    });
  </script>
  </>
)}
